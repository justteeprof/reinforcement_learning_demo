<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Reinforcement Learning ICU Ventilator Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0f172a;
      color: white;
      text-align: center;
      padding: 20px;
    }

    h1 {
      color: #38bdf8;
    }

    .icu {
      display: flex;
      justify-content: space-around;
      margin-top: 30px;
      flex-wrap: wrap;
    }

    .panel {
      background: #1e293b;
      padding: 20px;
      border-radius: 12px;
      width: 300px;
      margin: 10px;
    }

    label {
      display: block;
      margin-top: 10px;
    }

    input[type=range] {
      width: 100%;
    }

    button {
      margin-top: 15px;
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      background: #22c55e;
      color: black;
      font-weight: bold;
      cursor: pointer;
    }

    button:hover {
      background: #16a34a;
    }

    .patient {
      font-size: 80px;
      margin-top: 20px;
    }

    .status {
      font-size: 20px;
      margin-top: 10px;
    }

    .feedback {
      font-size: 40px;
      margin-top: 10px;
    }

    .ai {
      background: #020617;
      border: 2px solid #38bdf8;
    }

    .good {
      color: #22c55e;
    }

    .bad {
      color: #ef4444;
    }

  </style>
</head>
<body>

<h1>üß† Reinforcement Learning ICU Ventilator Game</h1>
<p>Human and AI take turns adjusting ventilator settings. The AI learns from rewards.</p>

<div class="icu">

  <!-- HUMAN PANEL -->
  <div class="panel">
    <h2>üë®‚Äç‚öïÔ∏è Human Doctor</h2>

    <label>Oxygen (FiO‚ÇÇ)</label>
    <input type="range" id="humanO2" min="21" max="100" value="40">

    <label>Pressure</label>
    <input type="range" id="humanPressure" min="5" max="30" value="15">

    <button onclick="humanTurn()">Apply Settings</button>
  </div>

  <!-- PATIENT -->
  <div class="panel">
    <h2>ü´Å Patient</h2>
    <div id="patient" class="patient">üòÆ‚Äçüí®</div>
    <div id="status" class="status">Breathing unstable</div>
    <div id="feedback" class="feedback"></div>
  </div>

  <!-- AI PANEL -->
  <div class="panel ai">
    <h2>ü§ñ AI Agent</h2>
    <p>Learning from human decisions</p>
    <button onclick="aiTurn()">AI Adjusts Ventilator</button>
    <p id="aiKnowledge">Knowledge level: Low</p>
  </div>

</div>

<script>
  let aiO2 = 40;
  let aiPressure = 15;
  let aiSkill = 0; // learning progress

  const OPTIMAL_O2 = 50;
  const OPTIMAL_PRESSURE = 18;

  function evaluate(o2, pressure) {
    const diff = Math.abs(o2 - OPTIMAL_O2) + Math.abs(pressure - OPTIMAL_PRESSURE);
    return diff < 10 ? "good" : "bad";
  }

  function updatePatient(result) {
    const patient = document.getElementById("patient");
    const status = document.getElementById("status");
    const feedback = document.getElementById("feedback");

    if (result === "good") {
      patient.textContent = "üòä";
      status.textContent = "Breathing well";
      status.className = "status good";
      feedback.textContent = "üëç";
    } else {
      patient.textContent = "üò´";
      status.textContent = "Breathing poorly";
      status.className = "status bad";
      feedback.textContent = "üëé";
    }
  }

  function humanTurn() {
    const o2 = parseInt(document.getElementById("humanO2").value);
    const pressure = parseInt(document.getElementById("humanPressure").value);

    const result = evaluate(o2, pressure);
    updatePatient(result);

    // AI learns from human
    if (result === "good") {
      aiO2 = (aiO2 + o2) / 2;
      aiPressure = (aiPressure + pressure) / 2;
      aiSkill += 1;
    }
  }

  function aiTurn() {
    // AI explores less as skill increases
    aiO2 += (OPTIMAL_O2 - aiO2) * (0.2 + aiSkill * 0.1);
    aiPressure += (OPTIMAL_PRESSURE - aiPressure) * (0.2 + aiSkill * 0.1);

    const result = evaluate(aiO2, aiPressure);
    updatePatient(result);

    if (result === "good") {
      aiSkill += 1;
    }

    document.getElementById("aiKnowledge").textContent =
      "Knowledge level: " + (aiSkill < 3 ? "Low" : aiSkill < 6 ? "Medium" : "Expert");
  }
</script>

</body>
</html>
